#!/bin/bash

root="`git rev-parse --show-cdup`"
if [ $? != 0 ] ; then exit 1 ; fi 

regex='$^'
if [ -f "$root".searchignore ] ; then
	while read glob ; do
		regex="$regex|^$glob"'$'
	done  < <(cat "$root".searchignore | sed -E 's/[.]/[.]/g' | sed -E 's/[*]/.*/g' | sed -E 's/[?]/./g')
fi

while read file ; do
	# Filter out symlinks
	if [ ! -L "$file" ] ; then echo $file ; fi
done < <(git ls-files "$root" -co --exclude-standard | grep -v -E "$regex")

